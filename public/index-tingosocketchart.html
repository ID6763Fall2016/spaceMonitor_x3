<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Lasor curtter monitor">
        <meta name="author" content="Cheryl Wang">

        <title>laser cutter monitor</title>     

        <!-- Bootstrap Core CSS -->
        <link href="public/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="public/css/main.css" rel="stylesheet">

        <!-- Morris Charts CSS -->
        <link href="public/css/plugins/morris.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="publicfont-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

        <!-- Latest compiled and minified JavaScript -->
        <script src="public/js/jquery.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.js"></script>
        <script src="/socket.io/socket.io.js"></script>

    </head>
    <body>

          <div id="page-wrapper">

            <div class="container-fluid">

                <!-- Page Heading -->
                <div class="row">
                    <div class="col-lg-12">
                        <h1 class="page-header header-icon">
                            Laser Cutter Monitor <small>Status Overview</small>
                        </h1>
                    </div>
                </div>
                <!-- /.row -->

                <div class="row">
                    <div class="col-lg-4 col-md-4">
                        <div class="info-bubble">
                            <h4> Temperature </h4>
                            <div class="bubble-img normal">25.1</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4">
                        <div class="info-bubble">
                            <h4> Machine Status </h4>
                            <div class="img">
                                <img alt="" src="public/images/cutter_available.png"></img>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4">
                            <div class="info-bubble">
                                <h4> Warning message sent </h4>
                                <div class="mail-icon">6</div>
                            </div>
                    </div>
                <!-- /.row -->

                <div class="row">
                    <div class="col-lg-12">

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title"><i class="fa fa-bar-chart-o fa-fw"></i> Area Chart</h3>
                            </div>
                            <div class="panel-body">
                                <div id="morris-area-chart">
                                    <div style="width: 100%">
                                        <canvas id="canvas" height="450" width="600"></canvas>
                                     </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.row -->


            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- /#page-wrapper -->

 <script>
 window.onload =  function(){
	initLineChart();
 }

var socket = io();
var lineChartData = {
	labels: Array(100).fill(0),
	datasets: [
		{
			label: "My first dataset",
			fillColor: "rgba(220, 220, 220, 0.2)",
			strokeColor: "rgba(220, 220, 220, 1)",
			pointColor: "rgba(220, 220, 220, 1)",
			pointHighlightFill: "#fff",
			pointStrokeColor: "#fff",
			pointHighlightStroke: "rgba(220, 220, 220, 1)",
			data: Array(100).fill(0)
		}
	]
}

socket.on('latestSamples', function(incomingData){
	console.log(incomingData);
	socket.emit('messageFromClientToServer', "received: "+incomingData);
	lineChartData.datasets[0].data = incomingData;
	initLineChart();
});

var initLineChart = function(){
	var options = {
		animation: false,
		responsive: true
	};
	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	window.myLineChart = new Chart(ctx).Line(lineChartData, options);
}

 </script>

    </body>
</html>
